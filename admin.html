<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Panel de Control - Proyecto Navidad 4.0</title>

    <link rel="stylesheet" href="css/style.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="admin-view">
    <div id="app-root">
      <header class="admin-header">
        <h1 class="titulo">Panel de Control</h1>

        <div id="system-status" class="status-badge warning">
          Iniciando sesi√≥n...
        </div>
      </header>

      <div class="admin-main-container">
        <div class="admin-column" id="path-container">
          <h2 class="admin-column-title">
            <span>üì° Monitor de Ruta</span>
          </h2>
          <div id="visual-path"></div>
        </div>

        <div class="admin-column" id="details-container">
          <h2 class="admin-column-title">
            <span>üéõÔ∏è Centro de Comando</span>
          </h2>

          <div id="details-cards">
            <p style="color: var(--admin-text-muted)">
              Conectando con la base de datos...
            </p>
          </div>

          <div style="margin-top: 2rem">
            <h3
              class="path-branch-title"
              style="border: none; padding: 0; margin-bottom: 1rem"
            >
              Registro de Actividad
            </h3>
            <ul id="attempts-list" class="admin-attempts-list">
              <li style="padding: 1rem; color: #666">Esperando datos...</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";

      // --- IMPORTANTE: Agregamos Auth para tener permisos de escritura ---
      import {
        getAuth,
        signInAnonymously,
        onAuthStateChanged,
      } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";

      import {
        getFirestore,
        doc,
        setDoc,
        getDoc,
        collection,
        onSnapshot,
        query,
        orderBy,
        getDocs,
        deleteDoc,
        limit,
      } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

      // TUS CREDENCIALES
      const firebaseConfig = {
        apiKey: "AIzaSyBAv3HFQifOmS78tRYvo8yM4Um_PX0d_sk",
        authDomain: "regalonavidad-9304b.firebaseapp.com",
        projectId: "regalonavidad-9304b",
        storageBucket: "regalonavidad-9304b.firebasestorage.app",
        messagingSenderId: "920626025677",
        appId: "1:920626025677:web:ee800a9860410818fc0584",
      };

      // Exponer SDK al script global
      window.firebaseAdminSDK = {
        firebaseConfig,
        initializeApp,
        // Auth
        getAuth,
        signInAnonymously,
        onAuthStateChanged,
        // Firestore
        getFirestore,
        doc,
        setDoc,
        getDoc,
        collection,
        onSnapshot,
        query,
        orderBy,
        getDocs,
        deleteDoc,
        limit,
      };
    </script>

    <script type="module" src="js/admin.js"></script>
  </body>
</html>
